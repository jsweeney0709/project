# -*- coding: utf-8 -*-
"""
Created on Sat Nov 27 22:15:10 2021

@author: jswee
"""

# -*- coding: utf-8 -*-
"""
Created on Sat Nov 27 13:31:02 2021

@author: jswee
"""
import numpy as np
import matplotlib.pyplot as plt
from PIL import Image

plotListX=[0.21100268088884008, 0.21424136762027515, 0.21748005435171025, 0.22071874108314532, 0.2239574278145804, 0.22719611454601546, 0.23043480127745053, 0.23367348800888563, 0.2369121747403207, 0.24015086147175577, 0.24338954820319084, 0.24662823493462593, 0.249866921666061, 0.2531056083974961, 0.25634429512893114, 0.2595829818603662, 0.2628216685918013, 0.26606035532323635, 0.2692990420546714, 0.2725377287861065, 0.2757764155175416, 0.2790151022489767, 0.28225378898041176, 0.2854924757118468, 0.2887311624432819, 0.29196984917471697, 0.29520853590615204, 0.2984472226375871, 0.3016859093690222, 0.3049245961004573, 0.30816328283189237, 0.31140196956332744, 0.3146406562947625, 0.3178793430261976, 0.32111802975763265, 0.3243567164890677, 0.3275954032205028, 0.33083408995193786, 0.334072776683373, 0.337311463414808, 0.3405501501462431, 0.3437888368776782, 0.34702752360911326, 0.35026621034054833, 0.3535048970719834, 0.3567435838034185, 0.35998227053485354, 0.36322095726628867, 0.3664596439977237, 0.3696983307291588, 0.3729370174605938, 0.37617570419202895, 0.379414390923464, 0.3826530776548991, 0.38589176438633416, 0.3891304511177692, 0.39236913784920435, 0.39560782458063937, 0.3988465113120745, 0.4020851980435095, 0.40532388477494463, 0.4085625715063797, 0.41180125823781477, 0.41503994496924984, 0.4182786317006849, 0.42151731843212, 0.42475600516355505, 0.4279946918949902, 0.4312333786264252, 0.4344720653578603, 0.43771075208929533, 0.44094943882073045, 0.4441881255521655, 0.4474268122836006, 0.45066549901503566, 0.45390418574647073, 0.45714287247790586, 0.4603815592093409, 0.463620245940776, 0.466858932672211, 0.47009761940364614, 0.47333630613508115, 0.4765749928665163, 0.4798136795979514, 0.4830523663293864, 0.48629105306082154, 0.48952973979225656, 0.4927684265236917, 0.4960071132551267, 0.4992457999865618, 0.5024844867179968, 0.505723173449432, 0.508961860180867, 0.5122005469123021, 0.5154392336437372, 0.5186779203751722, 0.5219166071066074, 0.5251552938380424, 0.5283939805694775, 0.5316326673009125, 0.5348713540323476, 0.5381100407637827, 0.5413487274952178, 0.5445874142266529, 0.5478261009580879, 0.551064787689523, 0.5543034744209581, 0.5575421611523932, 0.5607808478838282, 0.5640195346152633, 0.5672582213466983, 0.5704969080781335, 0.5737355948095685, 0.5769742815410036, 0.5802129682724387, 0.5834516550038737, 0.5866903417353089, 0.5899290284667439, 0.593167715198179, 0.596406401929614, 0.5996450886610492, 0.6028837753924842, 0.6061224621239193, 0.6093611488553544, 0.6125998355867894, 0.6158385223182246, 0.6190772090496596, 0.6223158957810947, 0.6255545825125297, 0.6287932692439648, 0.6320319559753999, 0.635270642706835, 0.6385093294382701, 0.6417480161697051, 0.6449867029011402, 0.6482253896325753, 0.6514640763640104, 0.6547027630954454, 0.6579414498268805, 0.6611801365583155, 0.6644188232897507, 0.6676575100211857, 0.6708961967526208, 0.6741348834840559, 0.6773735702154909, 0.6806122569469261, 0.6838509436783611, 0.6870896304097962, 0.6903283171412312, 0.6935670038726663, 0.6968056906041014, 0.7000443773355365, 0.7032830640669716, 0.7065217507984066, 0.7097604375298416, 0.7129991242612768, 0.7162378109927118, 0.7194764977241469, 0.722715184455582, 0.725953871187017, 0.7291925579184522, 0.7324312446498872, 0.7356699313813223, 0.7389086181127573, 0.7421473048441924, 0.7453859915756275, 0.7486246783070626, 0.7518633650384977, 0.7551020517699327, 0.7583407385013679, 0.7615794252328029, 0.764818111964238, 0.768056798695673, 0.7712954854271081, 0.7745341721585431, 0.7777728588899783, 0.7810115456214133, 0.7842502323528484, 0.7874889190842835, 0.7907276058157185, 0.7939662925471537, 0.7972049792785887, 0.8004436660100238, 0.8036823527414588, 0.806921039472894, 0.810159726204329, 0.8133984129357641, 0.8166370996671992, 0.8198757863986342, 0.8231144731300694, 0.8263531598615044, 0.8295918465929395, 0.8328305333243745, 0.8360692200558096, 0.8393079067872447, 0.8425465935186798, 0.8457852802501149, 0.8490239669815499, 0.852262653712985, 0.85550134044442, 0.8587400271758552, 0.8619787139072902, 0.8652174006387253, 0.8684560873701603, 0.8716947741015955, 0.8749334608330305, 0.8781721475644656, 0.8814108342959007, 0.8846495210273357, 0.8878882077587709, 0.8911268944902059, 0.894365581221641, 0.897604267953076, 0.9008429546845111, 0.9040816414159462, 0.9073203281473813, 0.9105590148788164, 0.9137977016102514, 0.9170363883416865, 0.9202750750731216, 0.9235137618045567, 0.9267524485359917, 0.9299911352674268, 0.9332298219988618, 0.936468508730297, 0.939707195461732, 0.9429458821931671, 0.9461845689246022, 0.9494232556560372, 0.9526619423874724, 0.9559006291189074, 0.9591393158503425, 0.9623780025817775, 0.9656166893132127, 0.9688553760446477, 0.9720940627760828, 0.9753327495075179, 0.9785714362389529, 0.981810122970388, 0.9850488097018231, 0.9882874964332582, 0.9915261831646932, 0.9947648698961283, 0.9980035566275633, 1.0012422433589985, 1.0044809300904336, 1.0077196168218687, 1.0109583035533038, 1.0141969902847388, 1.0174356770161739, 1.020674363747609, 1.0239130504790441, 1.027151737210479, 1.0303904239419142, 1.0336291106733493, 1.0368677974047844, 1.0401064841362195, 1.0433451708676544, 1.0465838575990896, 1.0498225443305247, 1.0530612310619598, 1.0562999177933947, 1.0595386045248298, 1.062777291256265, 1.0660159779877, 1.0692546647191352, 1.0724933514505701, 1.0757320381820052, 1.0789707249134404, 1.0822094116448755, 1.0854480983763104, 1.0886867851077455, 1.0919254718391807, 1.0951641585706158, 1.0984028453020507, 1.1016415320334858, 1.104880218764921, 1.108118905496356, 1.1113575922277912, 1.114596278959226, 1.1178349656906612, 1.1210736524220963, 1.1243123391535315, 1.1275510258849664, 1.1307897126164015, 1.1340283993478366, 1.1372670860792717, 1.1405057728107069, 1.1437444595421418, 1.146983146273577, 1.150221833005012, 1.1534605197364471, 1.156699206467882, 1.1599378931993172, 1.1631765799307523, 1.1664152666621874, 1.1696539533936225, 1.1728926401250575, 1.1761313268564926, 1.1793700135879277, 1.1826087003193628, 1.1858473870507977, 1.1890860737822329, 1.192324760513668, 1.195563447245103, 1.1988021339765382, 1.2020408207079731, 1.2052795074394083, 1.2085181941708434, 1.2117568809022783, 1.2149955676337134, 1.2182342543651485, 1.2214729410965837, 1.2247116278280186, 1.2279503145594537, 1.2311890012908888, 1.234427688022324, 1.237666374753759, 1.240905061485194, 1.244143748216629, 1.2473824349480642, 1.2506211216794993, 1.2538598084109343, 1.2570984951423694, 1.2603371818738045, 1.2635758686052396, 1.2668145553366748, 1.2700532420681097, 1.2732919287995448, 1.27653061553098, 1.279769302262415, 1.28300798899385, 1.286246675725285, 1.2894853624567202, 1.2927240491881553, 1.2959627359195904, 1.2992014226510253, 1.3024401093824605, 1.3056787961138956, 1.3089174828453307, 1.3121561695767656, 1.3153948563082007, 1.3186335430396359, 1.321872229771071, 1.3251109165025061, 1.328349603233941, 1.3315882899653761, 1.3348269766968113, 1.3380656634282464, 1.3413043501596813, 1.3445430368911164, 1.3477817236225516, 1.3510204103539867, 1.3542590970854216, 1.3574977838168567, 1.3607364705482918, 1.363975157279727, 1.367213844011162, 1.370452530742597, 1.3736912174740321, 1.3769299042054672, 1.3801685909369024, 1.3834072776683373, 1.3866459643997724, 1.3898846511312075, 1.3931233378626426, 1.3963620245940778, 1.3996007113255127, 1.4028393980569478, 1.406078084788383, 1.409316771519818, 1.412555458251253, 1.415794144982688, 1.4190328317141232, 1.4222715184455583, 1.4255102051769935, 1.4287488919084284, 1.4319875786398635, 1.4352262653712986, 1.4384649521027337, 1.4417036388341686, 1.4449423255656038, 1.4481810122970389, 1.451419699028474, 1.4546583857599091, 1.457897072491344, 1.4611357592227792, 1.4643744459542143, 1.4676131326856494, 1.4708518194170843, 1.4740905061485194, 1.4773291928799546, 1.4805678796113897, 1.4838065663428248, 1.4870452530742597, 1.4902839398056948, 1.49352262653713, 1.496761313268565, 1.5]
plotListY=[-4.034255978533811, -3.0853365286055316, -2.5826016980405067, -2.313837451521746, -2.098609940158518, -1.9251317887865746, -1.80671062113872, -1.6347791042426723, -1.587077780449226, -1.4927160695555537, -1.4126869780676923, -1.3377592956620628, -1.2740602280100064, -1.2090996038728996, -1.1611837813915007, -1.1108127909108785, -1.063767256844701, -1.017778087544882, -0.978406407829145, -0.9410323096065457, -0.9050956611502439, -0.8709197143829729, -0.8385240524928573, -0.8078240622367615, -0.7786526761253847, -0.7508672953646085, -0.7243388762453342, -0.6989545248458147, -0.6746165414531677, -0.6512408157222676, -0.6287539438561087, -0.6070513572630585, -0.5860935798592953, -0.5658534179337045, -0.546285640496057, -0.5273452046904722, -0.5090065244391767, -0.4912367434687088, -0.4740042605649834, -0.4572785854233489, -0.44103068303544346, -0.425223511976894, -0.40982818316311775, -0.39486490884202774, -0.3803293291983526, -0.3661285204476858, -0.35223771049844066, -0.33916427274630084, -0.32596979492953126, -0.31306342847074564, -0.30051045491320955, -0.2882326149352643, -0.27620399901038795, -0.264405545103989, -0.25281728481352284, -0.24142116951063686, -0.23020130948209602, -0.21915511614499913, -0.2089082971431975, -0.19840297245165117, -0.18807614808483414, -0.1779223717315184, -0.16793646753617997, -0.15811121604808692, -0.14844030529265834, -0.1389175544409661, -0.1295374824265658, -0.12029528748605918, -0.11118664373911377, -0.10220746504206439, -0.09335386931306541, -0.08382523264183207, -0.07525745167249534, -0.06680524360445342, -0.058463366295784226, -0.05022743099677488, -0.04209364107892414, -0.03405904770462582, -0.026120583856329267, -0.01827508395432428, -0.00951864544038346, -0.0019716730546677588, 0.005499553415234707, 0.012897264959416897, 0.02022227673036642, 0.027475747385352356, 0.034659047476756424, 0.0417735010404818, 0.04882040404855522, 0.05580103419336488, 0.0627166561990912, 0.06956852463833667, 0.07635788529720484, 0.08308597568268132, 0.08578049761754776, 0.09246468646830017, 0.09908745577035549, 0.10565072869880854, 0.11215631418492558, 0.11860609592550872, 0.12500197985143574, 0.1313449844043742, 0.13763657915539856, 0.14387816724289898, 0.15007109162824167, 0.15621664049538322, 0.16231605192276505, 0.16837051793708394, 0.1743811880420663, 0.18034917230151007, 0.1862755440435043, 0.19216134224257136, 0.19800757362742635, 0.2038152145546301, 0.20958521268191566, 0.2153184884696365, 0.22101593653413182, 0.22667842687308387, 0.2323068059796359, 0.2379018978594305, 0.2434645049624722, 0.24899540903985748, 0.2544953719339319, 0.25996513630907375, 0.26540542632935044, 0.2708169482883353, 0.27620039119569756, 0.2815564273245634, 0.2868857127231283, 0.2921888876935955, 0.29746657724115727, 0.30271939149541505, 0.3079479261064134, 0.313152762617199, 0.31833446881467975, 0.3234935990603161, 0.3286306946021385, 0.33374628386935695, 0.3388408827507888, 0.3439149948582087, 0.3489691117756375, 0.3540037132955247, 0.3590192676427239, 0.36401623168705305, 0.3689950511452666, 0.37395616077313093, 0.378899984548334, 0.38382693584486255, 0.38232015852024626, 0.3875256587168766, 0.3927067020424806, 0.3978637753577947, 0.4029973524759659, 0.408107894594359, 0.41319585071042125, 0.4182616580219419, 0.42330574231243523, 0.42832851832215285, 0.4333303901051712, 0.4383117513731326, 0.44327298582611663, 0.4482144674711138, 0.4531365609285251, 0.4580396217272175, 0.4629239965884197, 0.4677900236990919, 0.4726380329749235, 0.47746834631353746, 0.48228127783822794, 0.4870771341325498, 0.49185621446621647, 0.4966188110125786, 0.5013652090580591, 0.5060956872039103, 0.5108105175606119, 0.5155099659351946, 0.5201942920119212, 0.5248637495265337, 0.5295185864344917, 0.5341590450734292, 0.5387853623202601, 0.5433977697431405, 0.5479964937486991, 0.5525817557247823, 0.5571537721791164, 0.5617127548740823, 0.5662589109580674, 0.5707924430935306, 0.5753135495822344, 0.5798224244878205, 0.584319257756056, 0.588804235332981, 0.5932775392812278, 0.5977393367712933, 0.6021894378212996, 0.606627955333795, 0.6110556128452758, 0.6154725748304725, 0.6198790023334593, 0.62427505304975, 0.6286608814073374, 0.6330366386469048, 0.6374024729013743, 0.6417585292749185, 0.6461049499216248, 0.6504418741238968, 0.6547695541289033, 0.6590886134909864, 0.6633985472933013, 0.6676994853522165, 0.6719915549653105, 0.6762748809898996, 0.6805495859215247, 0.6848157899722931, 0.6890736111489526, 0.6933231653305186, 0.6975645663452861, 0.7017979260469945, 0.706023354389921, 0.7102409595026394, 0.7144508477602022, 0.7186531238544411, 0.7228478908621551, 0.7270352503108919, 0.731215302242085, 0.735388145271316, 0.7395538766454784, 0.7437125922966878, 0.7478643868927766, 0.7520093538842745, 0.7561475855478118, 0.7602791730259293, 0.7644042063633049, 0.7685227745394789, 0.772634965498168, 0.7767408661733263, 0.7808405625121198, 0.7849341394950408, 0.78902168115337, 0.7931032705842692, 0.7971789899637424, 0.8012489205577664, 0.8053131427318461, 0.8093717359592798, 0.8134247788284045, 0.8174723490490607, 0.8215145234585364, 0.8255513780271911, 0.8295829878639737, 0.8336094272220006, 0.8376307695043562, 0.8416470872702434, 0.8456584522415802, 0.8496649353101468, 0.8536666065453122, 0.8576635352024098, 0.861655789731762, 0.865643437788366, 0.8696265462422182, 0.873605181189255, 0.8775794079628675, 0.8815492911459337, 0.8855148945833189, 0.8894762813947535, 0.893433513988041, 0.8973866540724946, 0.9013357626725278, 0.9052809001413089, 0.9092221261743914, 0.9131594998232344, 0.9170930795085068, 0.9210229230331068, 0.9249490875947713, 0.9288716297982192, 0.9327906056667087, 0.9367060706529251, 0.940618079649118, 0.9445266869963739, 0.948431946492962, 0.9523339114016391, 0.9562326344558355, 0.9601281678646403, 0.9640205633164858, 0.9679098719814591, 0.9717961445121505, 0.9756794310429683, 0.9795597811878274, 0.9834372440361663, 0.9873118681471958, 0.9911837015423524, 0.9950527916958668, 0.9989191855234462, 1.0027829293689994, 1.0066440689894232, 1.010502649537407, 1.0143587155423084, 1.0182123108890955, 1.0220634787954384, 1.0259122617870078, 1.0297587016710945, 1.033602839508681, 1.0374447155851263, 1.0412843693796667, 1.0451218395339483, 1.0489571638198898, 1.0527903791071405, 1.0566215213305061, 1.0604506254577193, 1.0642777254579354, 1.0681028542714524, 1.0719260437810814, 1.075747324785712, 1.0795667269765503, 1.0833842789166066, 1.0872000080239401, 1.0910139405592063, 1.0948261016180294, 1.0986365151286854, 1.102445203855566, 1.1062521894088275, 1.110063044555184, 1.1138879266649853, 1.1177095506644619, 1.1215290608739183, 1.125346583615766, 1.1291621339058628, 1.1329757264876168, 1.1367873758364206, 1.1405970961661849, 1.144404901433481, 1.1482108053417617, 1.152014821346162, 1.1558169626577153, 1.159617242245265, 1.1634156728402771, 1.1672122669373173, 1.1710070367967198, 1.1747999944457876, 1.1785911516782837, 1.18238052005429, 1.1861681108990227, 1.1899539352997888, 1.1937380041029613, 1.1975203279086832, 1.2013009170654956, 1.2050797816623064, 1.208856931519459, 1.2126323761778735, 1.2164061248863887, 1.2201781865866645, 1.223948569895845, 1.2277172830868148, 1.2314843340651433, 1.2352497303431722, 1.239013479010179, 1.2427755866987096, 1.2465360595462887, 1.2502949031520683, 1.2540521225278645, 1.2578077220428334, 1.2615617053608466, 1.2653140753698877, 1.269064834102085, 1.2728139826435847, 1.2765615210323773, 1.2803074481428733, 1.284053069251193, 1.2877975041291936, 1.2915404809579587, 1.2952820095612276, 1.2990220996964712, 1.3027607610542076, 1.306498003257075, 1.3102338358586973, 1.313968268342184, 1.3177013101182646, 1.3214329705229426, 1.3251632588144744, 1.3288921841695291, 1.3326197556781838, 1.336345982337416, 1.3400708730425501, 1.3437944365759495, 1.3475166815920223, 1.3512376165972455, 1.3549572499235134, 1.3586755896924865, 1.3623926437678326, 1.3661084196911681, 1.3698229245960116, 1.3735361650920093, 1.3772481471088982, 1.3809588756857354, 1.384668354685401, 1.3883765864066215, 1.3920835710545625, 1.3957893060148514, 1.399493784852052, 1.4031978973132706]





    
img=Image.open("C:/Users/jswee/OneDrive/Desktop/Project/milkyway.jpg")
imageCopy=Image.open("C:/Users/jswee/OneDrive/Desktop/Project/milkyway.jpg")

newbiggest=0.207763994157405

width=img.size[0]
height=img.size[1]
halfWidth=int(width/2)
halfHeight=int(height/2)

counter1=0
counter2=0
for j in range(height):
    for i in range(width):
        counter1+=1
        if counter1%int(height*width/100)==0:
            counter2+=1
            counter1=0
            print(counter2)
        x=int(i-halfWidth)
        pixx=i
        y=halfHeight-j
        pixy=j
        if x!=0:
            p=(x/abs(x))*(1.56/halfHeight)*(x**2+y**2)**(1/2)
        if x==0:
            p=(1.56/halfHeight)*(x**2+y**2)**(1/2)
        if p<-newbiggest:
            aprime=-np.interp(-p,plotListX,plotListY)
            iprime=int((aprime*(x/p))+halfWidth)%width
            jprime=int(-(aprime*(y/p))+halfHeight)%height
            if iprime==jprime==0:
                img.putpixel((pixx,pixy),(255,20,147))
            else:
                img.putpixel((pixx,pixy),imageCopy.getpixel((iprime,jprime)))
#-jprime if wrong          
        elif p>newbiggest:
            aprime=np.interp(p,plotListX,plotListY)
            iprime=int((aprime*(x/p))+halfWidth)%width
            jprime=int(-(aprime*(y/p))+halfHeight)%height
            if iprime==jprime==0:
                img.putpixel((pixx,pixy),(255,20,147))
            else:
                img.putpixel((pixx,pixy),imageCopy.getpixel((iprime,jprime)))
        else:
            img.putpixel((pixx,pixy),(0,0,0))
            
figure, ax = plt.subplots()
ax.axis("equal")
ax.get_xaxis().set_visible(False)
ax.get_yaxis().set_visible(False)
img.save("C:/Users/jswee/OneDrive/Desktop/Project/milkyway-SC-test.jpg")        

plt.imshow(img)
plt.show()